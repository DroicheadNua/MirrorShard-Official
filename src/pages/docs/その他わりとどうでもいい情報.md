---
layout: ../../layouts/PostLayout.astro
title: その他わりとどうでもいい情報
date: 2026-02-24
---


※Readmeに書くような情報ではないものや、開発の裏話的な何か。  

# 動作確認済みの環境とその考察  

Tauriでの開発でもっとも厄介なのは、各OSのWebViewの挙動に振り回されるところではないかと思う。  

一応、OS間の差異を吸収するためにVersoブラウザ(Servoベース)を搭載するプロジェクトとかもあるそうだが、肝心のServoがまだアルファ版の段階なので、現状の助けにはなりそうもない。CEF（Chromium Embedded Framework）なんてものもあるみたいだが、こっちも現状では難しそうである。  

## Windows  
◯Win11（Core i5 13400F, 32GB RAM, RTX3060）  

Tauri移植の恩恵を最も受けたのはWindows版で、懸案だった起動速度が劇的に速くなった。  

WebView2のおかげで描画も安定しており、目立った不具合もない。Tauriとの相性がもっとも良いのはWindowsのようである。今後もこれを軸に開発することになるだろう。  

## MacOS  
△MacOS Tahoe（Mac mini M4, 16GB Unified Memory）  

Electronでは優等生だったMacOSだが、Tauri版の開発は苦労が多い。関連付けでテキストファイルを開くだけでもopen-fileイベントを拾うための専用の処理を書かなければならないのだが、加えてWebKit (Safari) とTauriの相性があまり良くないようで、範囲選択時の不具合や、ウィンドウの角丸めが効かない（解決済み）問題など、いくつかの問題に悩まされた。  

またMacはMirrorShard無印（Electron）の起動も割と高速で、無理にTauriに移植する意味が薄いのではないかという疑問もあった（ファイルサイズは劇的に小さくなるが）。

……というわけで一時は開発停止まで視野に入れていたのだが、どうやら難所は抜けたようで、現在は開発中にそこまでの苦労はない。現状ではなんだかんだで（範囲選択の問題以外は）おおむね正常に動作しており、開発者自身の普段使いのエディタとして日々活躍している。  
機能の追加も進んでいるため、すでにElectron版よりこちらの方が使い勝手が良い。  

懸案だった範囲選択の問題は、Tauriのアップデートもあってある程度の改善に成功した。スクロールバーをドラッグして広範囲を選択したりすると正しく動作しないのだが、それ以外は改善されたように思える。全選択もできるようになった。  

## Linux  
△MX Linux（Core i7 9700, 24GB RAM, グラフィックボードなし）  
×MX Linux（Core i7 7700, 16GB RAM, GTX1050Ti）
△MX Linux（Raspberry Pi 5, 8GB RAM）  
×Raspberry Pi OS（Raspberry Pi 5, 8GB RAM）  

残念ながら、Linux版のバイナリは配布を停止した。正常に動作しない環境が多いからである。  

上記の通りDebian系のディストリビューションしか試していないのだが、WaylandやNvidiaのグラフィックボードを使用した環境では画面を表示することすらできず、起動オプション（WEBKIT_DISABLE_COMPOSITING_MODE=1など）をつければ一応動作はするものの、それでもやはり描画周りに不具合が多い。  

「X11環境」「グラフィックボードなし」という条件下なら動作はするが、それでもIME周りの表示バグがあり、半透明ウィンドウとスポットライトモードを併用したときなどに特定条件下でバグが発生することも確認している。  
また、マークダウンプレビューウィンドウも起動しない。  

ただ動作自体は軽く、Raspberry Piでも結構軽快に動作する。Raspberry Pi用の文書作成ソフトなんてものはそれほど多くないだろうし、また巨大テキストファイルを扱えるエディタはそれなりに希少なので、「巨大テキストの扱える軽量アウトラインプロセッサ」として運用するならそれなりに有用かもしれない。  

なお開発者自身が使ってみた感触では、Linuxではダークモード（ないし黒背景の半透明ウィンドウ）のほうがきれいに描画されるように思える。ライトモード（とくに背景画像使用時）は、描画にどことなく違和感がある。  
……というより、そもそもLinuxではElectron版を使った方がいいのかもしれない。  


# コードエディタモードについて  

本エディタはあくまで文書執筆が主眼であり、コードエディタモードはあくまで補助的な機能と位置づけている。そのため重い処理は極力排し、最低限の機能しか実装していない。  
はっきり言ってしまえば、あるのはシンタックスハイライトとブラケットマッチング、AIを用いない旧型のオートコンプリートくらいなもので、リンターもフォーマッターもなく、言語対応も限られている。  
AIチャットウィンドウがあるので一応バイブコーディングのようなことはできるが、本格的な開発には向かないだろう（MirrorShardのコードもAntigravityで書かれている）。  
その後v1.1.0でAIを利用したコード補完機能を搭載したが、さすがにAntigravityやCursorのような使い方をするのは無理である。  

ただ、本エディタは起動が比較的速く、Codemirror 6を採用しているため巨大テキストの扱いにも長けている。普段使いのついでにちょっとしたコーディングをするとか、何かの巨大なログをチェックしたいとか、用途によっては使い道があるかも知れない。  

なお、本エディタのHTMLプレビュー機能を使用する際にはエディタ側をコードエディタモードにしておいた方がよい（そうしないとシンタックスハイライトが効かない）。  

ちなみにコードエディタモードの配色はTokyo Nightをベースにしているが、普通にインストールすると上手く動かなかったので配色だけをお借りしている。  
そのまま使うのも何なので、グローエフェクトと軽い透過をつけてみた。本当はもうちょっと派手に光らせてサイバーパンクなアトモスフィアにしたかったのだが、可読性を下げては本末転倒なので諦めた。  
なお、この配色は通常モードのテーマプリセットにも採用し、そちらではほぼオリジナルの配色のままになっている。  

開発者自身は割と気に入っているのだが、普通のTokyo Night Themeの方が使いやすいようなら元に戻すかも知れない。  

## 追記  
結局、ワードラップ設定の追加との兼ね合いで、画面の透過はとりやめた（横スクロール時、透過した行番号の下にコードが表示されてしまうため）。文字のグローエフェクトは残ったままだが、それ以外は普通のTokyo Nightテーマである（降雪エフェクトは適用可能だが）。  

また、v1.2.0で簡易フォーマッタを追加した。Oxfmtの採用も考えたのだが、今回は見送った。どのみちどう頑張っても本格的なIDEには勝てないので、本体機能の軽量性と高速性を維持する方が望ましいだろう。  

# BGMについて  

v1.2.0で、本エディタの添付BGMを自作（AI生成）のものに差し替えた。  

これは自作の楽曲を採用したかったというよりは、単純にファイルサイズの問題である。本作MirrorShard2はElectron版に較べて大幅にファイルサイズが削減されているが、その小さなファイルサイズのうち、かなりの部分をBGMが占めているという状況になっていた。  

お借りした楽曲はとても素敵な曲だったので残したいのは山々だったのだが、自作BGMに差し替えた結果、11.9MB（Windows版）あった配布バイナリのサイズは約6MBにまで大幅に減少した。  
Electron版のバイナリが183MBあったのに較べると、なんと30分の1以下である。Tauriというフレームワークの優秀さがうかがえる。  

また、お借りした楽曲は利用規約（素材そのものの再配布禁止）に配慮して簡単に取り出せないよう加工する必要があったが、自作音源ならその必要もないから実装もシンプルになった。  

なお、楽曲生成にはACE-step 1.5を用いている。添付画像も音楽もAI生成になったわけだが、そもそもコードの大半をAIで生成しているこのエディタにとっては、むしろ相応しいのかも知れない。  

# コードの内訳  

本エディタのリポジトリにおいて、Languages欄の表記は長らく

Typescript 98.3%  
Others 1.7%

のように表示されていた。
これは実態からかけ離れた表示だったのだが、なぜこうなっていたのかというと、上記の旧添付BGMが原因である。これが拡張子.tsのファイルに文字列化して収められていたため、その膨大な文字列がTypescriptのコードとして解釈されてしまっていたのである。  
現在（v1.2.0開発中）では、以下のように表示されている。  

TypeScript 61.3%
CSS 21.1%
HTML 10.4%
Rust 7.2% 

Rustの比率は7.2％しかないのだが、Gemini君によると、これでもTauriプロジェクトにしてはかなり高いそうである。「通常のTauriアプリはRust側を「ただの起動ランチャー」として使いがちですが、MirrorShardはファイル操作、PTY（ターミナル）、Pandoc連携、ウィンドウ制御など、バックエンド側でかなりガッツリ処理を書いていることの証明です」だそうだ。  

とはいえ根幹となるエディタライブラリにはCodeMirror6を採用しているし、AIとの通信にもGoogle公式が提供している@google/generative‑aiを使っていたりする関係上、結局はTypescriptのコード量の方が圧倒的に多いのだが。  

# アイデアプロセッサ機能について  

正式版v1.0.0リリースを以てElectron版MirrorShardからの機能移植はほとんど完了したのだが、唯一移植が済んでいないのがアイデアプロセッサ機能である。  

実装に苦労が多い割にユーザーからの反応が全くない機能ではあるのだが、しかし私自身の執筆活動においては非常に重要な機能で、これがなければ私にとっての「ぼくのかんがえたさいきょうのエディタ」は完成しない。  

実現はもう少し先になるとは思うが、少なくとも本機能の移植が完了するまでは開発を続けるつもりでいる。  


